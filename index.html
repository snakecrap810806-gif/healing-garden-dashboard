<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ë””ì§€í„¸ ì¹˜ìœ ì •ì› Â· ì‹¤ì‹œê°„ í™˜ê²½ ëŒ€ì‹œë³´ë“œ</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3"></script>

<style>
/* CSS ë³€ìˆ˜: í°íŠ¸/ìƒ‰ ëŒ€ë¹„ ìœ ì§€ */
:root{
Â  --bg:#071613; --panel: radial-gradient(160% 200% at 50% -40%, #0c241e 0%, #061815 70%);
Â  --ink:#dff9ef; /* ë©”ì¸ í°íŠ¸ ìƒ‰ìƒ */
Â  --muted:#bfead8; /* ë³´ì¡° í°íŠ¸ ìƒ‰ìƒ */
Â  --good:#22c58b; --ok:#ffd166; --bad:#ff7b7b;
Â  --cardBorder: rgba(191,234,216,.18); --grid:#123229;
Â  --chart-text:#bfead8; /* ì°¨íŠ¸ í°íŠ¸ ìƒ‰ìƒ (ë°°ê²½ê³¼ ëŒ€ë¹„ ìœ ì§€) */
Â  --chart-grid:rgba(191,234,216,.18); --chart-axis:rgba(191,234,216,.38);
}
*{ box-sizing:border-box }

/* ëª¨ë°”ì¼/ë°ìŠ¤í¬í†± ì•ˆì •ì„± í™•ë³´ë¥¼ ìœ„í•œ ë†’ì´ ì„¤ì • */
html{height:100%}
body{ margin:0; font-family:'Pretendard',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
Â  color:var(--ink); background:radial-gradient(140% 160% at 50% -30%, #0f2d25 0%, #071613 65%);
Â  min-height: 100vh; /* ìµœì†Œ ë†’ì´ ì„¤ì • */
}

/* í—¤ë” */
.header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:22px 26px 12px}
.title{font-weight:800;letter-spacing:.4px;font-size:34px}
.header__right{display:flex;gap:10px;align-items:center}
.chip-time{color:var(--muted);font-size:14px;opacity:.9}

/* ë²„íŠ¼ */
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;
Â  border:1px solid rgba(191,234,216,.2);cursor:pointer;background:#0d241d;color:var(--ink);
Â  font-weight:800;letter-spacing:.2px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.06);
Â  transition:transform .12s,box-shadow .12s,background .12s}
.btn:hover{transform:translateY(-1px);box-shadow:0 8px 22px rgba(0,0,0,.25),inset 0 0 0 1px rgba(255,255,255,.12)}
.btn--primary{background:var(--good);color:#04251b;border-color:transparent}

/* ê·¸ë¦¬ë“œ */
.grid{padding:10px 22px 18px;display:grid;gap:14px;grid-template-columns:repeat(4,1fr)}

/* ì¹´ë“œ */
.card{position:relative;border:1px solid var(--cardBorder);background:var(--panel);border-radius:16px;
Â  padding:16px 16px 58px;min-height:170px;box-shadow:0 12px 40px rgba(0,0,0,.3)}
.card__top{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.card__label{display:flex;align-items:center;gap:8px;font-weight:800;letter-spacing:.2px}
.bullet{width:9px;height:9px;border-radius:50%;background:var(--good);box-shadow:0 0 0 3px rgba(34,197,139,.15)}
.badge{font-size:12px;padding:4px 10px;border-radius:999px;font-weight:800;background:#0b2a22;border:1px solid rgba(191,234,216,.18);color:var(--muted)}
.badge--good{background:rgba(34,197,139,.18);color:#22c58b;border-color:rgba(34,197,139,.38)}
.badge--warn{background:rgba(255,209,102,.18);color:#ffd166;border-color:rgba(255,209,102,.38)}
.badge--bad{background:rgba(255,123,123,.18);color:#ff7b7b;border-color:rgba(255,123,123,.38)}

.card__value{font-weight:800;font-size:40px;letter-spacing:.2px;line-height:1.1;margin:8px 0 2px}
.card__unit{color:var(--muted);font-size:14px;margin-left:6px}
.card__hint{color:var(--muted);font-size:12px;margin:4px 0 6px;opacity:.9}

/* â­ ìŠ¤íŒŒí¬ë¼ì¸ ê³ ì • ì˜ì—­: í˜ëŸ¬ë‚´ë¦¼(canvas ë†’ì´ê°€ ì»¤ì§€ëŠ” ë¬¸ì œ) ë°©ì§€ ìµœì¢… ìˆ˜ì • */
.spark-wrap{height:56px;overflow:hidden; position: relative;} /* ë†’ì´ ê³ ì • */
.spark{height:100% !important; width:100%; display:block; max-height: 100% !important; min-height: 100% !important; } /* ìº”ë²„ìŠ¤ ë†’ì´ ê°•ì œ ê³ ì • */

/* ê·¸ë˜í”„ ë²„íŠ¼ ë™ì‘ í™•ì¸ */
.btn-graph{position:absolute;right:12px;bottom:12px;z-index:2;display:inline-flex;gap:6px;align-items:center;
Â  background:#22c58b;color:#062a1f;border:0;border-radius:999px;padding:8px 12px;font-size:13px;font-weight:800;
Â  letter-spacing:.2px;cursor:pointer;box-shadow:0 6px 16px rgba(34,197,139,.25),inset 0 0 0 1px rgba(255,255,255,.18)}
.btn-graph::before{content:"ğŸ“ˆ"}

/* ëª¨ë‹¬ ê³µí†µ */
.modal{position:fixed;inset:0;display:none;background:rgba(0,0,0,.55);align-items:center;justify-content:center;z-index:90}
.modal.is-open{display:flex}
.modal__panel{width:min(1200px,92vw);height:min(76vh,900px);background:radial-gradient(120% 140% at 50% 0%,#0e2620 0%,#061815 80%);
Â  border:1px solid rgba(191,234,216,.2);border-radius:18px;box-shadow:0 18px 60px rgba(0,0,0,.5);overflow:hidden;display:flex;flex-direction:column}
.modal__bar{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid rgba(191,234,216,.18);color:#bfead8;font-weight:800}
.modal__close{background:transparent;color:#bfead8;border:0;font-weight:800;cursor:pointer}
/* ëª¨ë‹¬ ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ: flex-1ë¡œ ëª¨ë‹¬ í¬ê¸°ì— ë§ì¶° ìœ ë™ì ìœ¼ë¡œ ë†’ì´ í™•ë³´ */
.modal__canvas-wrap{padding:14px 14px 18px;flex:1;min-height:0}
/* Canvasì— width/height 100% ì„¤ì •ì´ ì¤‘ìš”í•¨ (Chart.js ì˜µì…˜ìœ¼ë¡œ ì œì–´ ê°€ëŠ¥í•˜ì§€ë§Œ CSSì—ì„œë„ ë³´ì¡°) */
#detailChart{width:100%;height:100%;display:block}

/* ì¢…í•©í‰ê°€ */
.eval-wrap{padding:16px;display:grid;gap:12px;grid-template-columns:repeat(4,1fr);overflow-y:auto} /* ëª¨ë°”ì¼ì—ì„œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ë„ë¡ overflow-y:auto ì¶”ê°€ */
.eval-card{border:1px solid var(--cardBorder);background:var(--panel);border-radius:14px;padding:16px;display:flex;gap:12px;align-items:center}
.eval-card__title{font-weight:800}
.eval-card__score{margin-left:auto;font-weight:800;flex-shrink:0} /* ì ìˆ˜ê°€ ì˜ë¦¬ì§€ ì•Šë„ë¡ flex-shrink:0 ì¶”ê°€ */
.eval-overall{margin:12px 16px 6px;padding:12px 14px;border-radius:12px;border:1px solid var(--cardBorder);background:#0b241e;font-weight:800}

/* í‘¸í„° ë¡œê³  */
.footer{padding:6px 16px 22px;color:var(--muted);font-size:12px;display:flex;gap:8px;align-items:center;justify-content:center}
.footer img{height:18px;opacity:.92}

/* ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ ê°œì„  */
@media (max-width:1200px){
Â  .grid{grid-template-columns:repeat(2,1fr)}
Â  .card__value{font-size:34px}
Â  .eval-wrap{grid-template-columns:repeat(2,1fr)} /* íƒœë¸”ë¦¿ì—ì„œ 2ì—´ */
}
@media (max-width:680px){
Â  .header{padding:16px 16px 8px; flex-wrap:wrap} /* ëª¨ë°”ì¼ í—¤ë” */
Â  .header__right{margin-top:6px; width:100%; justify-content:stretch}
Â  .header__right .btn{flex:1; justify-content:center}
Â  .grid{grid-template-columns:1fr; padding:8px 16px 16px}
Â  .title{font-size:26px}
Â  .card__value{font-size:30px}
Â  .eval-wrap{grid-template-columns:1fr} /* ëª¨ë°”ì¼ì—ì„œ 1ì—´ */
Â  .modal__panel{width:98vw; height:90vh} /* ëª¨ë°”ì¼ ëª¨ë‹¬ í¬ê¸° ì¡°ì • */
}
</style>
</head>
<body>

<header class="header">
Â  <div class="title">ë””ì§€í„¸ ì¹˜ìœ ì •ì› Â· ì‹¤ì‹œê°„ í™˜ê²½ ëŒ€ì‹œë³´ë“œ</div>
Â  <div class="header__right">
Â  Â  <span class="chip-time" id="timeNote">-</span>
Â  Â  <button class="btn" id="btnViewMonitor">ëª¨ë‹ˆí„°ë§</button>
Â  Â  <button class="btn" id="btnViewEval">ì¢…í•©í‰ê°€</button>
Â  Â  <button class="btn btn--primary" id="btnRefresh">ì§€ê¸ˆ ìƒˆë¡œê³ ì¹¨</button>
Â  </div>
</header>

<main class="grid" id="grid"></main>

<footer class="footer">
Â  <img alt="êµ­ë¦½ì •ì›ë¬¸í™”ì› ë¡œê³ " src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjgwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjgwIDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZvbnQtZmFtaWx5PSJQcmV0ZW5kYXJkLCBzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iODAwIj48cGF0aCBkPSJNMCAyMGM2MC0xMCA5MC0xMCAxNTAuNSAwUzI0MCAzMCAyODAgMjAiIGZpbGw9IiNmZmYiIGZpbGwtb3BhY2l0eT0iLjkwIi8+PHRleHQgeD0iMTQiIHk9IjI5IiBmb250LXNpemU9IjE0IiBmaWxsPSIjZmZmIj7qsIDslYjqsJDsnbTqsIQg7ZiE7J6l66m07Yq4PC90ZXh0PjwvZz48L3N2Zz4=" />
Â  <span>Â· Healing Garden Â· Dark Forest UI (single-file)</span>
</footer>

<div id="chartModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
Â  <div class="modal__panel">
Â  Â  <div class="modal__bar">
Â  Â  Â  <strong id="chartTitle">ìƒì„¸ ê·¸ë˜í”„</strong>
Â  Â  Â  <button type="button" class="modal__close" id="closeChart">ë‹«ê¸° âœ•</button>
Â  Â  </div>
Â  Â  <div class="modal__canvas-wrap"><canvas id="detailChart"></canvas></div>
Â  </div>
</div>

<div id="evalModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
Â  <div class="modal__panel">
Â  Â  <div class="modal__bar">
Â  Â  Â  <strong>ì¢…í•© í‰ê°€</strong>
Â  Â  Â  <button type="button" class="modal__close" id="closeEval">ë‹«ê¸° âœ•</button>
Â  Â  </div>
Â  Â  <div id="evalOverall" class="eval-overall">ì¢…í•© ìƒíƒœ ê³„ì‚° ì¤‘â€¦</div>
Â  Â  <div class="eval-wrap" id="evalWrap"></div>
Â  </div>
</div>

<script>
const ITEMS = [
Â  { key:'pm10', label:'PM10',Â  unit:'Âµg/mÂ³', color:'#50f4c2' },
Â  { key:'pm25', label:'PM2.5', unit:'Âµg/mÂ³', color:'#5bd6ff' },
Â  { key:'co2',Â  label:'COâ‚‚',Â  Â unit:'ppm',Â  Â color:'#ffe36e' },
Â  { key:'temp', label:'ì˜¨ë„',Â  Â unit:'â„ƒ',Â  Â  Â color:'#ffb386' },
Â  { key:'hum',Â  label:'ìŠµë„',Â  Â unit:'%RH',Â  Â color:'#b2f1dd' },
Â  { key:'lux',Â  label:'ì¡°ë„',Â  Â unit:'lux',Â  Â color:'#84ffc9' },
Â  { key:'noise',label:'ì†ŒìŒ',Â  Â unit:'dB',Â  Â  color:'#a7b8ff' },
Â  { key:'wind', label:'í’ì†',Â  Â unit:'m/s',Â  Â color:'#93f6f2' },
];
function statusOf(key,val){
Â  switch(key){
Â  Â  case 'pm10': return val<50 ? 'ì¢‹ìŒ' : (val<100?'ì£¼ì˜':'ë‚˜ì¨');
Â  Â  case 'pm25': return val<25 ? 'ì¢‹ìŒ' : (val<50?'ì£¼ì˜':'ë‚˜ì¨');
Â  Â  case 'co2' : return val<800 ? 'ì¢‹ìŒ' : (val<1200?'ì£¼ì˜':'ë‚˜ì¨');
Â  Â  case 'temp': return (val>=18&&val<=26) ? 'ì¢‹ìŒ' : 'ì£¼ì˜';
Â  Â  case 'hum' : return (val>=40&&val<=60) ? 'ì¢‹ìŒ' : 'ì£¼ì˜';
Â  Â  case 'lux' : return (val>=200&&val<=800)? 'ì¢‹ìŒ' : 'ì£¼ì˜';
Â  Â  case 'noise':return val<60 ? 'ì¢‹ìŒ' : (val<75?'ì£¼ì˜':'ë‚˜ì¨');
Â  Â  case 'wind': return val<5 ? 'ì¢‹ìŒ' : (val<9?'ì£¼ì˜':'ë‚˜ì¨');
Â  Â  default:return 'ì£¼ì˜';
Â  }
}
function badgeClass(s){ return s==='ì¢‹ìŒ' ? 'badge--good' : (s==='ì£¼ì˜'?'badge--warn':'badge--bad'); }
function getCss(name){ return getComputedStyle(document.documentElement).getPropertyValue(name).trim() }

/* Chart.js ê¸°ë³¸ ì„¤ì •: í°íŠ¸/ìƒ‰ ëŒ€ë¹„ ìœ ì§€ */
Chart.defaults.font.family = "'Pretendard',system-ui,-apple-system,Segoe UI,Roboto,sans-serif";
Chart.defaults.font.size = 12;
Chart.defaults.color = getCss('--chart-text');
Chart.defaults.plugins.legend.labels.color = Chart.defaults.color;
Chart.defaults.plugins.tooltip.titleColor = '#07241b';
Chart.defaults.plugins.tooltip.bodyColorÂ  = '#07241b';
Chart.defaults.plugins.tooltip.backgroundColor = 'rgba(191,234,216,.96)';

/* ìŠ¤íŒŒí¬ë¼ì¸ ì„¤ì • ìµœì í™”: ë†’ì´ ê³ ì •ì„ ìœ„í•´ maintainAspectRatio:false, aspectRatio:null ì„¤ì • */
const sparkOptions = {
Â  responsive:true, maintainAspectRatio:false, aspectRatio:null, /* ë†’ì´ 56px ê³ ì • */
Â  resizeDelay:0,
Â  animation:false,
Â  plugins:{ legend:{display:false}, tooltip:{enabled:true, mode:'index', intersect:false} },
Â  scales:{ x:{display:false}, y:{display:false} },
Â  elements:{ line:{ borderWidth:2, tension:.35 }, point:{ radius:0, hitRadius:6 } }
};

const historyMap = {};
const sparkCharts = {};
const dom = {
Â  grid: document.getElementById('grid'),
Â  timeNote: document.getElementById('timeNote'),
Â  btnRefresh: document.getElementById('btnRefresh'),
Â  btnViewEval: document.getElementById('btnViewEval'),
Â  btnViewMon : document.getElementById('btnViewMonitor'),
Â  chartModal: document.getElementById('chartModal'),
Â  chartTitle: document.getElementById('chartTitle'),
Â  chartClose: document.getElementById('closeChart'),
Â  detailCanvas: document.getElementById('detailChart'),
Â  evalModal: document.getElementById('evalModal'),
Â  evalClose: document.getElementById('closeEval'),
Â  evalWrap: document.getElementById('evalWrap'),
Â  evalOverall: document.getElementById('evalOverall'),
};
let detailChart;

function initCards(){
Â  const frag = document.createDocumentFragment();
Â  ITEMS.forEach(it=>{
Â  Â  const card = document.createElement('div');
Â  Â  card.className = 'card';
Â  Â  card.innerHTML = `
Â  Â  Â  <div class="card__top">
Â  Â  Â  Â  <div class="card__label"><span class="bullet"></span><span>${it.label}</span></div>
Â  Â  Â  Â  <span class="badge" id="badge-${it.key}">-</span>
Â  Â  Â  </div>
Â  Â  Â  <div>
Â  Â  Â  Â  <span class="card__value" id="val-${it.key}">-</span><span class="card__
